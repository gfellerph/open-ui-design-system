<fieldset>
  <legend class="sr-only">Color scheme</legend>
  <label>
    <span class="sr-only">Use system preference</span>
    <span aria-hidden="true">üíª</span>
    <input
      id="color-scheme-system"
      type="radio"
      name="color-scheme"
      value="system"
    />
  </label>
  <label>
    <span class="sr-only">Light</span>
    <span aria-hidden="true">‚òÄÔ∏è</span>
    <input
      id="color-scheme-light"
      type="radio"
      name="color-scheme"
      value="light"
    />
  </label>
  <label>
    <span class="sr-only">Dark</span>
    <span aria-hidden="true">üåô</span>
    <input
      id="color-scheme-dark"
      type="radio"
      name="color-scheme"
      value="dark"
    />
  </label>
</fieldset>

<style>
  fieldset {
    display: flex;
    border: 1px solid var(--color-border, #ddd);
    border-radius: 10rem;
    margin: 0;
    gap: 0.75rem;
    padding-block: 0.5rem;
  }

  label {
    display: flex;
    align-items: center;
    cursor: pointer;
    gap: 0.25rem;
  }

  input[type="radio"] {
    cursor: pointer;
    margin: 0;
  }
</style>

<script>
  const schemeRadios = document.querySelectorAll(
    'input[name="color-scheme"]'
  ) as NodeListOf<HTMLInputElement>;
  schemeRadios.forEach((radio) => {
    radio.addEventListener("change", (event) => {
      const selectedScheme = (event.target as HTMLInputElement).value;
      localStorage.setItem("color-scheme", selectedScheme);
    });
  });

  const savedScheme = localStorage.getItem("color-scheme");
  if (savedScheme) {
    const activeRadio = document.querySelector(
      `input[name="color-scheme"][value="${savedScheme}"]`
    ) as HTMLInputElement;
    if (activeRadio) activeRadio.checked = true;
  } else {
    const systemRadio = document.querySelector(
      'input[name="color-scheme"][value="system"]'
    ) as HTMLInputElement;
    if (systemRadio) systemRadio.checked = true;
  }
</script>
